<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WATCH-4-RBX | Auth</title>
<style>
/* GLOBAL */
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'SF Pro',sans-serif;user-select:none;-webkit-tap-highlight-color:transparent;}
body{background:#0a0a0a;color:#fff;display:flex;justify-content:center;align-items:flex-start;padding:20px 0;overflow:auto;}
.container{background:rgba(255,255,255,0.05);backdrop-filter:blur(18px);padding:20px;border-radius:22px;width:95%;max-width:420px;box-shadow:0 0 25px rgba(255,255,255,.05);display:flex;flex-direction:column;gap:12px;border-top:3px solid rgba(255,255,255,.2);}
h1{text-align:center;font-size:1.8rem;margin-bottom:5px;}
.tab-switch{display:flex;justify-content:center;margin-bottom:15px;gap:10px;}
.tab-switch button{flex:1;padding:10px;border:none;border-radius:12px;cursor:pointer;font-weight:700;transition:0.25s;background:rgba(255,255,255,0.05);color:#fff;}
.tab-switch button.active{background:#0f0f0f;border:1px solid rgba(255,255,255,.2);}
.tab-switch button:hover:not(.active){background:rgba(255,255,255,0.1);}
form{display:flex;flex-direction:column;gap:12px;}
input{padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.2);background:rgba(0,0,0,0.35);color:#fff;font-size:1rem;}
input:focus{border-color:#fff;outline:none;}
button.submit-btn{padding:12px;border-radius:12px;border:1.5px solid rgba(255,255,255,0.6);font-weight:700;cursor:pointer;transition:0.2s;background:rgba(15,15,15,0.8);color:#fff;backdrop-filter:blur(12px);}
button.submit-btn:hover{transform:scale(1.05);box-shadow:0 0 15px rgba(255,255,255,0.2);border-color:#fff;}
.forgot-pass{text-align:right;font-size:.85rem;opacity:.7;cursor:pointer;}
.msg{text-align:center;font-weight:600;margin-top:5px;}
.error{color:#ff4d4d;}
.success{color:#00ff99;}

/* FAQ dropdown */
.faq-section{margin-top:20px;display:flex;flex-direction:column;gap:10px;}
.faq-item{background:rgba(255,255,255,0.05);border-radius:12px;overflow:hidden;cursor:pointer;transition:0.2s;display:flex;flex-direction:column;}
.faq-item:hover{background:rgba(255,255,255,0.08);}
.faq-question{padding:12px 15px;font-weight:700;display:flex;align-items:center;gap:8px;}
.faq-question svg{width:18px;height:18px;fill:#fff;flex-shrink:0;}
.faq-answer{max-height:0;padding:0 15px;overflow:hidden;transition:max-height 0.3s ease, padding 0.3s ease;font-size:.85rem;opacity:0.85;}
.faq-item.active .faq-answer{max-height:300px;padding:10px 15px;}

/* Loader image */
.loader-container{margin-top:20px;position:relative;width:100%;height:200px;border-radius:18px;overflow:hidden;background:rgba(255,255,255,0.05);backdrop-filter:blur(15px);display:flex;justify-content:center;align-items:center;}
.loader-container img{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity 0.5s ease;}
.loader-glass{position:absolute;inset:0;background:rgba(0,0,0,0.4);backdrop-filter:blur(12px);display:flex;justify-content:center;align-items:center;font-size:1rem;font-weight:700;color:#fff;transition:opacity 0.4s ease;}
</style>
</head>
<body>

<div class="container">
  <h1>WATCH-4-RBX</h1>

  <div class="tab-switch">
    <button id="signupTab" class="active" onclick="switchTab('signup')">SIGN UP</button>
    <button id="loginTab" onclick="switchTab('login')">LOGIN</button>
  </div>

  <!-- SIGNUP FORM -->
  <form id="signupForm">
    <input type="text" id="suUsername" placeholder="Username">
    <input type="email" id="suEmail" placeholder="Email">
    <input type="password" id="suPassword" placeholder="Password">
    <button type="button" class="submit-btn" onclick="signupUser()">REGISTER</button>
    <div class="msg" id="signupMsg"></div>
  </form>

  <!-- LOGIN FORM -->
  <form id="loginForm" style="display:none;">
    <input type="email" id="liEmail" placeholder="Email">
    <input type="password" id="liPassword" placeholder="Password">
    <div class="forgot-pass" onclick="forgotPassword()">Forgot Password?</div>
    <button type="button" class="submit-btn" onclick="loginUser()">LOGIN</button>
    <div class="msg" id="loginMsg"></div>
  </form>

  <!-- FAQ / Info Section -->
  <div class="faq-section">
    <div class="faq-item">
      <div class="faq-question">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a10 10 0 100 20 10 10 0 000-20zm.5 15h-1v-1h1v1zm0-3h-1V7h1v7z"/></svg>
        Is my data safe?
      </div>
      <div class="faq-answer">Yes! All user information is stored securely and never shared with third parties.</div>
    </div>
    <div class="faq-item">
      <div class="faq-question">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 22c5.421 0 10-4.579 10-10s-4.579-10-10-10-10 4.579-10 10 4.579 10 10 10zm0-18c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zm-.5 11h1v1h-1v-1zm0-7h1v6h-1V8z"/></svg>
        Minimum withdrawal
      </div>
      <div class="faq-answer">You need at least 150 RBX to withdraw your balance for real Robux.</div>
    </div>
    <div class="faq-item">
      <div class="faq-question">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c2.206 0 4-1.794 4-4s-1.794-4-4-4-4 1.794-4 4 1.794 4 4 4zm0 2c-2.67 0-8 1.337-8 4v2h16v-2c0-2.663-5.33-4-8-4z"/></svg>
        How is everything saved?
      </div>
      <div class="faq-answer">Your progress, earnings, and account info are securely saved in Firebase in real-time.</div>
    </div>
  </div>

  <!-- Loader image -->
  <div class="loader-container">
    <div class="loader-glass" id="imageLoader">Loadingâ€¦</div>
    <img id="loaderImage" />
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, updateProfile } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
  authDomain:"itzhoyoo-f9f7e.firebaseapp.com",
  databaseURL:"https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
  projectId:"itzhoyoo-f9f7e",
  storageBucket:"itzhoyoo-filestorage.app",
  messagingSenderId:"1094792075584",
  appId:"1:1094792075584:web:d49e9c3f899d3cd31082a5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// TAB SWITCH
window.switchTab = (tab)=>{
  const su = document.getElementById("signupForm");
  const li = document.getElementById("loginForm");
  const suTab = document.getElementById("signupTab");
  const liTab = document.getElementById("loginTab");
  if(tab==='signup'){
    su.style.display='flex';li.style.display='none';
    suTab.classList.add('active');liTab.classList.remove('active');
  } else {
    su.style.display='none';li.style.display='flex';
    suTab.classList.remove('active');liTab.classList.add('active');
  }
};

// FRIENDLY ERROR HANDLER
function getFriendlyError(e){
  switch(e.code){
    case "auth/network-request-failed":
      return "Network issue: your internet might be slow or our servers are down. Try again later.";
    case "auth/wrong-password":
      return "Incorrect password. Try again.";
    case "auth/user-not-found":
      return "No account found with this email.";
    case "auth/email-already-in-use":
      return "This email is already registered.";
    case "auth/weak-password":
      return "Password is too weak. Use at least 6 characters.";
    case "auth/too-many-requests":
      return "Too many attempts. Please wait a few minutes.";
    default:
      return e.message || "Operation failed. Try again.";
  }
}

// SIGNUP
window.signupUser = async ()=>{
  const username = document.getElementById("suUsername").value;
  const email = document.getElementById("suEmail").value;
  const password = document.getElementById("suPassword").value;
  const msg = document.getElementById("signupMsg");
  msg.textContent="";msg.className="msg";
  if(!username || !email || !password){msg.textContent="Fill all fields";msg.className="msg error";return;}
  try{
    const userCred = await createUserWithEmailAndPassword(auth,email,password);
    await updateProfile(userCred.user,{displayName:username});
    await set(ref(db,`users/${userCred.user.uid}`),{username:username,rbxbalance:0});
    msg.textContent="Success! Redirecting...";msg.className="msg success";
    setTimeout(()=>location.href='../',1500);
  } catch(e){
    msg.textContent = getFriendlyError(e);
    msg.className="msg error";
  }
};

// LOGIN
window.loginUser = async ()=>{
  const email = document.getElementById("liEmail").value;
  const password = document.getElementById("liPassword").value;
  const msg = document.getElementById("loginMsg");
  msg.textContent="";msg.className="msg";
  if(!email || !password){msg.textContent="Fill all fields";msg.className="msg error";return;}
  try{
    await signInWithEmailAndPassword(auth,email,password);
    msg.textContent="Logged in! Redirecting...";msg.className="msg success";
    setTimeout(()=>location.href='../',1000);
  } catch(e){
    msg.textContent = getFriendlyError(e);
    msg.className="msg error";
  }
};

// FORGOT PASSWORD
window.forgotPassword = async ()=>{
  const email = document.getElementById("liEmail").value;
  const msg = document.getElementById("loginMsg");
  msg.textContent="";msg.className="msg";
  if(!email){msg.textContent="Enter your email";msg.className="msg error";return;}
  try{
    await sendPasswordResetEmail(auth,email);
    msg.textContent="Password reset email sent!";msg.className="msg success";
  } catch(e){
    msg.textContent = getFriendlyError(e);
    msg.className="msg error";
  }
};

// FAQ toggle
document.querySelectorAll('.faq-item').forEach(item=>{
  item.addEventListener('click',()=>item.classList.toggle('active'));
});

// Fixed loader image
const loaderImg = document.getElementById('loaderImage');
const loaderOverlay = document.getElementById('imageLoader');
const imgUrl = "https://i.ytimg.com/vi/P-vP6JkrIMs/maxresdefault.jpg";
const preImg = new Image();
preImg.src = imgUrl;
preImg.onload = ()=>{
  loaderImg.src = imgUrl;
  loaderImg.style.opacity=1;
  loaderOverlay.style.opacity=0;
  setTimeout(()=>loaderOverlay.style.display='none',400);
};
preImg.onerror = ()=>loaderOverlay.textContent="Failed to load image";
</script>
</body>
</html>